# heroscript
Console tool for upload tcx activities to velohero by merging Strava activity values.

# Introducing
Velohero is a platform to store your activity files (e.g. TCX). You can maintain additional data like training type, equipments etc. But you have to upload and maintain it by hand (tapikiik dosn't work fine). 

Strava has a nice app and is good for beeing connected with other athletes. My Garmin device sends the activity directly to Strava, so I can edit the activity data directly (Setting a proper name, used equipment etc.)

Heroscript is the bridge between Strava/Garmin to Velohero. It tooks the original TCX file from Garmin, adds the activity settings from Strava, so it can be updloaded without doing any additional value settings. After that, the TCX file will be archived on my local storage server. To bring this concept to work, all activity values have to be set in Strava.

Downloading from Garmin is out of scope, I use a fork of garmin-connect-export to download all new activities.

Heroscript is not a ready-to-use GUI application for the normal athlete. It is a tailored console script, designed for just my specific use case. But may be you have a similar constellation, so this script can help you as a starting point.

![Overview](https://github.com/chs8691/heroscript/blob/master/design/Diagram.png)

# Preconditions

## Python
You need Python 3.x on your local machine. The scripting is done on Ubuntu and should work an all Ubuntu environments, too. To use it on Windows or your own virtual environment, see requirements.txt for the used libraries (generated by pipreqs).

## Velohero
You need a Velohero account, of course. Set up heroscript with the Single-Sign-On ID from Velohero / Hello / Single-Sign-On / Single Sign On ID. For instance: 

$ heroscript config --velohero_sso_id kdRfmIHT6IVH1GI12345BIhaUpwTaQguuzE7FFs4

## STRAVA
For STRAVA, you need an to create an API whith a call back domain 'localhost'. From this API, you need the client ID and the Client Secret. Configure heroscript with this values:

$ venv/bin/python main.py config --strava_client_id 12345
$ venv/bin/python main.py config --strava_client_secret 509d7ed7ab29c93bb12345a05f3a1627c57e413f

## Local Web Server
A local webserver is used for STRAVA authentication. This server has a default port '4312' but can be change with the config command. For instance:

$ venv/bin/python main.py config --port 4444

# Install
Clone the repository and open a shell

## Usage
Heroscript can be explored by using its help:
 
$ venv/bin/python main.py --help

There are a couple of commands, but for the main use case, you just need this one:

### Setup
* config: Settings for authorization, directories etc.
* masterdata: Read equipments from Velohero and Strava and training types from Velohero

### Activity
* load: Read next TCX file from the local download direcory and merge its Strava activity settings
* transfer: Upload activity to Velohero, update Strava activity and move TCX file to the local archive directory

### Example
Step by step example to show how it works.
